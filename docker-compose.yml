version: '3.8'

services:
  # 共通のダッシュボード
  dashboard:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: delta-station-dashboard

    # データ永続化（outputsフォルダを参照）
    volumes:
      - ./outputs:/app/outputs

    # 環境変数
    environment:
      - TZ=Asia/Tokyo
      - PYTHONUNBUFFERED=1

    # ポート公開（8350でアクセス）
    ports:
      - "8350:8501"

    # 自動再起動設定
    restart: unless-stopped

    # Streamlitダッシュボード起動
    command: uv run streamlit run src/visualization/dashboard.py --server.port 8501 --server.address 0.0.0.0

# ネットワーク設定（共通）
networks:
  default:
    name: delta-station-network
